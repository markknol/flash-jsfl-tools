/** * Compiles all open documents, stops on compile error * @version 1.0 * @author: Mediamonks - http://www.mediamonks.com * @author: Mark Knol  - http://blog.stroep.nl */  var success = true;var totalSelectedDocs = 0;var totalPublishedDocs = 0;var log = "";var errorLog = "";var DOC_PREFIX = "doc_";var DOCUMENTS_PER_ROW = 3;var docs = fl.documents;var dialog = '<label value="Which documents do you want to compile?" />';// add documents to checkbox listfor (var i = 0; i < docs.length; i++) {	var doc = docs[i];	if (i%DOCUMENTS_PER_ROW==0) dialog += "<hbox>"	dialog += '<checkbox id="' + DOC_PREFIX + i + '" checked="true" label="' + doc.name + '" width="150"/>';	if (i%DOCUMENTS_PER_ROW==DOCUMENTS_PER_ROW-1) dialog += "</hbox>"}var settingsData = createDialogXML(dialog);if (settingsData.dismiss == 'accept'){	for (var name in settingsData) 	{		if (settingsData[name] == "true")		{			var index = parseInt(name.split(DOC_PREFIX).join(""));			var doc = docs[index];			doc.publish();						var saveFileURI = fl.configURI + doc.name + ".errors"			fl.compilerErrors.save(saveFileURI);						var contents = FLfile.read(saveFileURI);						FLfile.remove(saveFileURI);						if (contents.split("\n").length > 1 || contents.split("\r").length > 1) 			{				log += (doc.name + " publish error!\n" );								errorLog += contents;				success = false;				break;			}			else			{				log += (doc.name + " published\n");				totalPublishedDocs++;			}						totalSelectedDocs ++;		}	}	log += ("\n\n***************************************************\nTotal movies published: " + totalPublishedDocs + "/" + totalSelectedDocs + " selected documents");		if (success == false) { log += "\n***************************************************\n\nErrors: " + errorLog; }	fl.outputPanel.trace(log);}function createDialogXML(xmlString, description){	var dialogXML = '<dialog title="Confirm ' + (description? " - " + description : "") + '" buttons="accept, cancel" >';	dialogXML += '<vbox>';	dialogXML += 	 xmlString;	dialogXML +='</vbox>';	dialogXML +='</dialog>';		var url = fl.configURI + '/Commands/temp-dialog-' + parseInt(Math.random() * 777 * 777) + '.xml';	FLfile.write(url, dialogXML);		var panelOutput = fl.getDocumentDOM().xmlPanel(url);		FLfile.remove(url); 		return panelOutput;}